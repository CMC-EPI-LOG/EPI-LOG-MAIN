# 테스트케이스 스크립트 (EPI-LOG)

본 문서는 `EPI-LOG`의 주요 사용자 흐름과 실패 케이스를 기준으로 한 **수동 테스트 스크립트**입니다.

## 1) 테스트 환경 / 사전 조건

- 브라우저: Chrome(최신), Safari iOS(최신), Android Chrome(최신)
- 화면 크기: 360x800(모바일), 430x932(iPhone), 768x1024(태블릿)
- 네트워크: 정상 / 느린 3G / 오프라인
- 필수 환경 변수
  - `NEXT_PUBLIC_DATA_API_URL`
  - `NEXT_PUBLIC_AI_API_URL`
  - `KAKAO_REST_API_KEY`
  - `NEXT_PUBLIC_KAKAO_JS_KEY`
  - `NEXT_PUBLIC_SITE_URL`
  - `NEXT_PUBLIC_GA_ID` 또는 `NEXT_PUBLIC_GA4_ID`
- 브라우저 권한
  - 위치 권한 허용/거부 시나리오 각각 테스트
- 캐시/스토리지
  - 최초 방문(로컬스토리지 비어 있음)
  - 재방문(로컬스토리지에 위치/프로필 저장됨)

---

## 2) 핵심 사용자 시나리오

### TC-01 앱 첫 진입 (위치 허용)

- 절차
  1. 새 탭에서 첫 방문
  2. 위치 권한 허용
- 기대 결과
  - 현재 위치 기반으로 `reverse-geocode` 호출
  - 위치 토스트 표시
  - `daily-report` 호출 후 카드 렌더링
  - 에러 없이 정상 완료

### TC-02 앱 첫 진입 (위치 거부)

- 절차
  1. 새 탭에서 첫 방문
  2. 위치 권한 거부
- 기대 결과
  - 토스트: 기본 위치 안내(서울 중구)
  - 기본 위치로 `daily-report` 호출
  - 카드 정상 렌더링

### TC-03 네트워크 느림/지연

- 절차
  1. 네트워크를 “느린 3G”로 설정
  2. 앱 로드
- 기대 결과
  - 로딩 카드(애니메이션) 표시
  - 완료 시 정상 카드로 전환

### TC-04 역지오코딩 실패

- 절차
  1. `reverse-geocode` 호출 실패(네트워크 차단/서버 에러)
- 기대 결과
  - 토스트 에러 표시
  - 기본 위치로 `daily-report` 재호출

---

## 3) 위치 변경 흐름 (Daum 우편번호)

### TC-05 위치 선택 모달 오픈/클로즈

- 절차
  1. 상단 위치 텍스트 클릭
  2. 모달 오픈 확인
  3. 닫기 버튼 클릭
- 기대 결과
  - 모달 열림/닫힘 정상 동작

### TC-06 위치 변경 적용

- 절차
  1. 주소 검색 후 결과 선택
  2. 모달 닫힘
- 기대 결과
  - 상단 표시가 `동`으로 변경
  - 내부 `stationName`은 `구`로 저장
  - 토스트 “위치 변경” 메시지 노출
  - `daily-report` 재호출

---

## 4) 온보딩(맞춤 설정)

### TC-07 온보딩 오픈

- 절차
  1. 우측 설정 버튼 클릭
- 기대 결과
  - 온보딩 모달 노출

### TC-08 나이/건강 상태 선택

- 절차
  1. 나이 그룹 클릭
  2. 건강 상태 클릭
- 기대 결과
  - 선택 버튼 스타일 변경
  - 선택 상태 유지

### TC-09 온보딩 제출

- 절차
  1. “결과 보러 가기” 클릭
- 기대 결과
  - 프로필 저장(zustand persist)
  - 모달 닫힘
  - `daily-report` 재호출

### TC-10 온보딩 재진입

- 절차
  1. 새로고침
  2. 설정 버튼 클릭
- 기대 결과
  - 기존 선택값이 저장되어 표시됨

---

## 5) 결정 카드 UI/콘텐츠

### TC-11 등급별 배경색

- 절차
  1. AirKorea 응답에서 grade를 변경(테스트 데이터/목업)
- 기대 결과
  - GOOD/NORMAL/BAD/VERY_BAD에 맞는 색상 적용

### TC-12 “자세한 이유” 토글

- 절차
  1. “자세한 이유 보기” 클릭
  2. 다시 클릭
- 기대 결과
  - 상세 텍스트/근거 목록 토글

### TC-13 마스크/활동 라벨

- 절차
  1. `maskRecommendation`, `activityRecommendation` 값 변경
- 기대 결과
  - 매핑 로직에 맞는 라벨 렌더링

---

## 6) 공유 기능

### TC-14 Web Share 지원 브라우저

- 절차
  1. 공유 버튼 클릭
- 기대 결과
  - 네이티브 공유 다이얼로그 표시
  - 취소/완료 시 에러 없이 종료

### TC-15 Web Share 미지원 브라우저

- 절차
  1. 공유 버튼 클릭
- 기대 결과
  - 현재 URL 클립보드 복사
  - 알림 메시지 표시

---

## 7) PWA 설치 프롬프트

### TC-16 Android 설치 프롬프트 노출

- 절차
  1. Android Chrome에서 앱 진입
  2. `beforeinstallprompt` 이벤트 발생
- 기대 결과
  - 하단 설치 프롬프트 노출
  - “앱 설치하기” 버튼 동작

### TC-17 iOS 설치 가이드 노출

- 절차
  1. iOS Safari에서 앱 진입
- 기대 결과
  - 공유 버튼/홈화면 추가 안내 노출

---

## 8) API 안정성/에러 핸들링

### TC-18 daily-report 실패

- 절차
  1. `/api/daily-report` 500 유도
- 기대 결과
  - 토스트 에러 표시
  - 로딩 종료 후 UI 유지

### TC-19 reverse-geocode 실패

- 절차
  1. `/api/reverse-geocode` 500 유도
- 기대 결과
  - 기본 위치로 폴백

---

## 9) GA 이벤트/페이지뷰

### TC-20 초기 페이지뷰

- 절차
  1. 앱 최초 진입
- 기대 결과
  - GA 초기 페이지뷰 전송

### TC-21 라우트 변경 페이지뷰

- 절차
  1. 쿼리 변경 또는 라우트 이동(가정)
- 기대 결과
  - `page_path`가 변경된 값으로 전송

---

## 10) 접근성/UX 체크

### TC-22 키보드 포커스

- 절차
  1. Tab 키로 버튼 이동
- 기대 결과
  - 주요 버튼 접근 가능

### TC-23 토스트 메시지 가독성

- 절차
  1. 에러/성공 토스트 발생
- 기대 결과
  - 메시지 텍스트가 명확히 보임

---

## 11) 회귀 테스트 체크리스트

- 위치 권한 허용/거부 시 정상 동작
- 온보딩 제출 후 데이터 재호출
- 로딩 → 결과 카드 전환
- 공유/설치 UX 동작
- GA 페이지뷰 정상 수집
